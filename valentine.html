<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Question</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="heart-container"></div>

    <canvas id="celebration-canvas"></canvas>

    <div class="container fade-in">
        
        <img src="us.jpg" alt="Us" class="main-photo">

        <h1 class="question-text">Clara, will you be my valentine?</h1>
        
        <p id="error-msg" class="error-msg">This isn't an option</p>

        <div class="buttons" id="button-group">
            <button class="choice-btn" onclick="handleYes()">Yes</button>
            <button class="choice-btn" id="no-btn" onclick="handleNo()">No</button>
        </div>
    </div>

    <script>
        // --- HEART LOGIC (Copied from Page 1) ---
        const heartContainer = document.getElementById('heart-container');
        let heartInterval; // Variable to control the timer

        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = 'â¤';
            
            heart.style.top = Math.random() * 100 + 'vh';
            heart.style.left = '-50px';
            heart.style.animationDuration = (Math.random() * 3 + 4) + 's';
            
            heartContainer.appendChild(heart);
            setTimeout(() => heart.remove(), 7000);
        }

        // Start hearts immediately
        heartInterval = setInterval(createHeart, 400);


        // --- BUTTON LOGIC ---
        let noCount = 0;
        const noBtn = document.getElementById('no-btn');
        const errorMsg = document.getElementById('error-msg');
        const buttonGroup = document.getElementById('button-group');
        const canvas = document.getElementById('celebration-canvas');
        const ctx = canvas.getContext('2d');

        function handleNo() {
            noCount++;
            errorMsg.style.opacity = '1';
            noBtn.classList.add('shake');
            setTimeout(() => noBtn.classList.remove('shake'), 500);

            if (noCount >= 3) {
                noBtn.style.display = 'none';
                errorMsg.innerText = "I told you, not an option!";
            } else {
                setTimeout(() => { errorMsg.style.opacity = '0'; }, 2000);
            }
        }

        function handleYes() {
            // 1. Hide UI
            buttonGroup.style.display = 'none';
            errorMsg.style.display = 'none';

            // 2. KILL THE HEARTS
            clearInterval(heartInterval); // Stop making new ones
            heartContainer.innerHTML = ''; // Remove existing ones from screen instantly
            
            // 3. Setup Canvas
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // 4. Start Confetti Loop
            loop();
            
            // 5. Fire first burst immediately
            shootConfetti();

            // 6. Set timer to shoot again every 3 seconds
            setInterval(shootConfetti, 3000);
        }


        // --- NEW CONFETTI PHYSICS ENGINE ---
        let particles = [];

        function shootConfetti() {
            // Create 200 particles per burst ("A lot")
            for (let i = 0; i < 200; i++) {
                particles.push({
                    x: Math.random() * canvas.width, // Spread across bottom width
                    y: canvas.height + 10,           // Start slightly below screen
                    vx: (Math.random() - 0.5) * 10,  // Horizontal spread (Left/Right)
                    vy: -(Math.random() * 15 + 10),  // Upward velocity (High negative Y)
                    gravity: 0.3,                    // Gravity to pull them back down
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    rotation: Math.random() * 360,
                    rotationSpeed: (Math.random() - 0.5) * 10
                });
            }
        }

        function loop() {
            requestAnimationFrame(loop);
            
            // Clear canvas every frame
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                
                // Physics
                p.vy += p.gravity; // Apply gravity
                p.x += p.vx;       // Move horizontal
                p.y += p.vy;       // Move vertical
                p.rotation += p.rotationSpeed;

                // Draw Confetti
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rotation * Math.PI / 180);
                ctx.fillStyle = p.color;
                ctx.fillRect(-4, -4, 8, 8); // Size of confetti
                ctx.restore();

                // Remove if it falls way below screen
                if (p.y > canvas.height + 100) {
                    particles.splice(i, 1);
                }
            }
        }
    </script>

</body>
</html>